> 短信验证码先存redis再发送短信

#### 提升QPS
- 提高并发数
    1. 能用多线程用多线程
    2. 增加各种连接数：Tomcat/Mysql/Redis等等
    3. 服务无状态，便于横向扩展，扩机器
    4. 让服务能力对等（serviceUrl 打乱顺序）
- 减少响应时间
    1. 异步（最终一致性，不需要及时）流量削峰
    2. 缓存（减少DB读取，减少磁盘IO，读多写少）
    3. 数据库优化
    4. 多的数据，分批次返回
    5. 减少微服务调用链
    6. 长连接（不要轮询）
#### 接口安全
1. xss：在正常用户请求中执行了黑客提供的恶意代码，问题出在用户数据没有过滤转义。jsoup、spring-htmlUtils、owasp-java-html-sanitizer
2. csrf: 冒充别人的登录信息，问题出在没有防范不信任的调用。人机交互、token

#### Eureka
- CAP
    1. 三级缓存registry/readWrite/readOnly，从其他peer拉去注册表 int registryCount = this.registry.syncUp()。（不满足C）
    2. 集群没有扩大承受能力，只是为了HA（满足A）。
    3. 网络不好的情况下续约不成功，还是可以拉取到注册表信息。（有自我保护，不续约并不是马上剔除。满足P）
- Server
    1. 注册（集群同步）
    2. 续约/心跳（集群同步）
    3. 下线（集群同步）
    4. 剔除（集群不同步：所有的节点都有定时任务）
    5. 获取注册列表（全量/增量）
> 集群间相互视为peer。Client向Server注册、续约、更新状态时，接受节点更新自己的服务注册信息后，逐个同步至其他peer节点。如果Server-A向Server-B节点单向注册，则Server-A视Server-B为peer节点，Server-A接受的数据会同步给Server-B，但Server-B接受的数据不会同步给Server-A。
- Client
    1. 从集群的第一个节点拉取注册信息，如果拉取失败从第二个，最多三次
    2. 从一级缓存
#### Config
SpringBoot的配置优先级
> 命令行参数 > 操作系统环境变量 > 应用外的配置文件 > 应用内的配置文件

这里命令行参数设置的优先级是最高的，方便部署不同环境。
加入SpringCloud的配置中心后，优先级并不是想象中的命令行最高优先级。

> 配置中心 > 命令行参数 > 本地application.yml > 本地bootstrap.yml
#### Security
并发量小可以用共享session；高并发换成无状态方案 JWT + Token

#### Sentinel
> java -Dserver.port=8080 -Dcsp.sentinel.dashboard.server=localhost:8080 -Dproject.name=sentinel-dashboard -jar sentinel-dashboard-1.8.1.jar
#### Nacos
> sh startup.sh -m standalone
